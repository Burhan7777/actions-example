name: push-workflow
on:
  push:
    branches:
      - main
jobs:
    build:
      runs-on: ubuntu-latest
      outputs:
        script-file: ${{steps.publish.outputs.script-file}}
      steps:
        - name: get code
          uses: actions/checkout@v3
        - name: Install dependencies
          run: npm ci
        - name: run lint test
          run: npm run lint
        - name: run tests
          run: npm run test
        - name: create build
          run: npm run build
        - name: publis JS name
          id: publish
          run: find dist/assets/*.js -type f -execdir echo 'script-file={}' >> $GITHUB_OUTPUT ';'
        - name: create artifact
          uses: actions/upload-artifact@v3
          with:
            name: files
            path: dist

    deploy:
        needs: build
        runs-on: ubuntu-latest
        steps: 
        - name: download artifact
          uses: actions/download-artifact@v3
          with:
            name: downloads
        - name: JS Output
          run: echo "${{needs.build.outputs.script-file}}"
        - name: deploy
          run: echo "Deploying"
      